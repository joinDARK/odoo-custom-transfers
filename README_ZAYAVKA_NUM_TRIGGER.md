# Триггер отслеживания изменений поля zayavka_num

## Описание

Данный триггер автоматически отслеживает все изменения поля `zayavka_num` (№ заявки) в модели `amanat.zayavka` и выводит информацию о изменениях в лог и консоль.

## Файлы

- `models/zayavka/zayavka_num_trigger.py` - основной файл с логикой триггера
- `models/zayavka/__init__.py` - обновлен для импорта триггера
- `test_zayavka_num_trigger.py` - демонстрационный скрипт для тестирования

## Функциональность

### Что отслеживается:

1. **Создание заявки** с установкой номера заявки
2. **Изменение номера заявки** с одного значения на другое

### Что логируется:

- При создании: `ТРИГГЕР ZAYAVKA_NUM: Создана новая заявка ID=X, № заявки установлен на значение 'Y'`
- При изменении: `ТРИГГЕР ZAYAVKA_NUM: № заявки изменился со значения 'X' на значение 'Y' для заявки ID=Z`

## Пример работы

```bash
ТРИГГЕР ZAYAVKA_NUM: Создана новая заявка ID=123, № заявки установлен на значение '1'
ТРИГГЕР ZAYAVKA_NUM: № заявки изменился со значения '1' на значение '2' для заявки ID=123
```

## Особенности реализации

1. **Двойной вывод**: Сообщения выводятся как в логгер (`_logger.info`), так и в консоль (`print`)
2. **Оптимизация**: Логирование происходит только при реальном изменении значения
3. **Обработка None**: Корректно обрабатываются случаи с пустыми значениями
4. **Наследование**: Использует паттерн наследования Odoo для расширения функциональности

## Тестирование

### Через Odoo Shell:

```bash
python3 odoo-bin shell -d your_database --addons-path=your_addons_path
```

```python
# В Odoo shell:
exec(open('/path/to/amanat/test_zayavka_num_trigger.py').read())
```

### Ручное тестирование:

```python
# Создание заявки
zayavka = env['amanat.zayavka'].create({
    'name': 'Тест',
    'zayavka_num': '1'
})

# Изменение номера
zayavka.write({'zayavka_num': '2'})
```

## Логирование

Триггер использует стандартный Python логгер с именем модуля. Сообщения появляются в:

1. **Odoo лог** (уровень INFO)
2. **Консоль** (через print для наглядности)

## Установка и активация

1. Файлы уже добавлены в модуль `amanat`
2. Перезапустите Odoo сервер для загрузки изменений
3. Обновите модуль `amanat` через интерфейс администратора

## Технические детали

- **Модель**: `amanat.zayavka` (наследование через `_inherit`)
- **Отслеживаемое поле**: `zayavka_num` (тип: `Char`)
- **Методы**: переопределены `create()` и `write()`
- **Логгер**: `logging.getLogger(__name__)`


