# Про файл methods.py
*P.S. Не за все методы в этом файле я шарю*

В `methods.py` отвечает за обработку и запуск автоматизация. Также в нем определены полезные методы, вот их список:
- `def _create_order(self, vals):` — Создает запись в ордерах
- `def _create_money(self, vals):` — Создает запись в контейнерах
- `def _create_reconciliation(self, vals):` — Создаем запись в сверках
- `def _get_currency_fields(currency, amount):` — Возвращает поле с валютой и суммой для `amanat.money`
- `def _get_reconciliation_currency_fields(currency, amount):` — Возвращает поле с валютой и суммой для `amanat.reconciliation`
- `def _get_first_payer(self, contragent):` — Возвращает первого плательщика из параметра `contragent`

Далее триггеры и вызываемые ими методы для автоматизаций (`<название_поля>: <метод_который_вызывается>, <еще_метод>`):

### def write(self, vals) (Обновляется запись)
- `fin_entry_check: run_all_fin_entry_automations()` — автоматизация "Вход заявки", которые могут сделать только финики. По сути во входе создаются ордера/контейнера/сверки для основных полей в заявке, а также вознаграждений
- `for_khalida_temp: run_for_khalida_automations()` — автоматизация для линка правил и прайс-листов. Они линкуются по определенным условиям (например чтобы эквивалент заявки в долларх подходил под диапазон суммы правила)
- `send_to_reconciliation: run_all_send_to_reconciliation_automations()` — автоматизация для "Выхода" заявки. В этом случае создаются ордера/контейнера/сверки для всего финансового расчет
- `link_jess_rate: run_link_jess_rate_automation()` — автоматизация, для линка курса Джесс
- `rate_fixation_date: run_link_jess_rate_automation(), run_price_list_automation()` — автоматизация, для линка курса Джесс и для линка прайс-листов. Также меняется статус заявки на `'3. Зафиксирован курс'`
- `swift_received_date: —` — автоматизация для смены статуса заявки на `12. Ждем поступление валюты`
- `swift_attachments: analyze_swift_documents_for_approved_date()` — автоматизация для смены статуса заявки на `12. Ждем поступление валюты`, статуса SWIFT на `'SWIFT получен'`, а также если не указана дата в поле `swift_received_date`, то ставит дату на момент срабатывания автоматизации. Также срабатывает автоматизация для анализа SWIFT
- `deal_closed_date: —` — автоматизация для смены статуса заявки на `21. Заявка закрыта`, статуса SWIFT на `'заявка закрыта'`
- `report_attachments: —` — автоматизация для смены статуса заявки на `21. Заявка закрыта`, статуса SWIFT на `'заявка закрыта'`, а также если не указана дата в поле `deal_closed_date`, то ставит дату на момент срабатывания автоматизации
- `rate_field: —` — автоматизация для смены статуса заявки на `3. Зафиксирован курс` а также ставит в поле `rate_fixation_date` дату на момент срабатывания автоматизации
- `zayavka_attachments: zayavka_analyse_with_yandex_gpt()` — автоматизация для анализа документа заявления
- `screen_sber_attachments: analyze_screen_sber_images_with_yandex_gpt()` — автоматизация для анализа скрина сбера
- `invoice_attachments: `