# Документация по компоненту AppsBar (Odoo/OWL)

## Описание
AppsBar — кастомный сайдбар для Odoo, реализованный на OWL (Odoo Web Library). Используется для быстрого доступа к основным разделам системы Amanat, поддерживает вложенные меню, drag-resize, сворачивание, динамическое управление видимостью и интеграцию с сервисами Odoo.

## Архитектура
- **JS:** `static/src/webclient/appsbar/appsbar.js`
- **XML:** `static/src/webclient/appsbar/appsbar.xml`
- **SCSS:** `static/src/webclient/appsbar/appsbar.scss`

## Структура меню
- Многоуровневое меню (основные разделы и вложенные пункты).
- Группы: валютные операции, вычислительные таблицы, справочники, золото, выписки, прайс-листы, кассы, заявки, автоматизации, логи, остальное.
- Каждый пункт меню может содержать вложенные items или быть action-элементом.

## Основные методы JS
- **setup()**: Инициализация состояния, меню, обработчиков событий, интеграция с сервисами Odoo (`actionService`, `companyService`, `appMenuService`).
- **handleMenuClick(menu, menu_index)**: Обработка клика по пункту меню (открытие/закрытие, запуск action).
- **toggleMenu(menu_index)**: Открытие/закрытие вложенного меню.
- **openAction(actionName, menuIndex)**: Запуск действия Odoo по имени.
- **startResize(event), onMouseMove(event), stopResize()**: Drag-resize сайдбара.
- **refreshMenuState()**: Динамическое управление видимостью и состоянием сайдбара в зависимости от текущего приложения.

## XML-шаблон
- Использует t-foreach для рендера меню и вложенных пунктов.
- Поддержка collapse/expand, drag-resize, адаптивная верстка.
- Кнопка сворачивания/разворачивания, разделитель для изменения ширины.

## Интеграция с OWL/Odoo
- Использует хуки OWL (`useState`, `onWillUnmount`), сервисы Odoo.
- Реагирует на события шины (`MENUS:APP-CHANGED`).
- Сохраняет состояние ширины сайдбара в localStorage.

## Best practices по расширению
- Для добавления новых разделов — расширяйте структуру `menuData` в JS.
- Для интеграции новых действий — добавляйте action и actionMethod.
- Для кастомизации внешнего вида — используйте SCSS-файл.
- Для поддержки новых бизнес-процессов — добавляйте обработчики в JS и шаблон XML.

## Пример добавления нового раздела
```js
this.menuData.push({
    name: 'Новый раздел',
    items: [
        { name: 'Мой пункт', action: 'amanat.my_action' },
    ],
});
```

## Важно
- Компонент работает только в приложении Amanat (state.isAmanat).
- Для корректной работы требуется интеграция с сервисами Odoo и корректная регистрация actions. 